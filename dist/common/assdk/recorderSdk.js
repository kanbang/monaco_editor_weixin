"use strict";function init(){function e(e,u){var l=e.args,v=l.operationType,f=l.duration,R=l.format;if("start"===v){R=R||"aac";var m={mimeType:"audio/webm"};navigator.mediaDevices.getUserMedia(g).then(function(e){r=e,t=[];try{o=new MediaRecorder(r,m)}catch(e){return s.error("voiceSdk.js Exception while creating MediaRecorder: "+e.toString()),void u({errMsg:"operateRecorder:fail "+e.toString()})}o.onstart=function(){i=+new Date},o.onstop=function(){var e=d.getCurrentProject(),r=new Blob(t,{type:"audio/webm"});i=+new Date-i;var a=new FileReader;a.addEventListener("loadend",function(){var r=n.copyFileDataToTemp(a.result,e.hash,".durationTime="+i+"."+R);o=void 0;var t={tempFilePath:r,fileSize:a.result.length,duration:i,state:"stop"};c.postMessageToAS({eventName:"onRecorderStateChange",data:t}),c.toggleRecordWording(!1)}),a.readAsDataURL(r)},o.ondataavailable=function(e){e.data&&e.data.size>0&&t.push(e.data)},o.onerror=function(e){var r={state:"error",errMsg:e.message};c.postMessageToAS({eventName:"onRecorderStateChange",data:r}),c.toggleRecordWording(!1)},u({errMsg:"operateRecorder:ok"}),f=f||p,a=setTimeout(function(){o&&o.stop()},f),o.start(10),c.toggleRecordWording(!0)}).catch(function(e){u({errMsg:"operateRecorder:fail "+e.name})})}else if("pause"===v){var M="operateRecorder:ok";o?o.pause():M="operateRecorder:fail",u({errMsg:M});var h={state:"pause"};c.postMessageToAS({eventName:"onRecorderStateChange",data:h}),c.toggleRecordWording(!1)}else if("resume"===v){var S="operateRecorder:ok";o?o.resume():S="operateRecorder:fail",u({errMsg:S}),c.toggleRecordWording(!0)}else if("stop"===v){var w="operateRecorder:ok";o?o.stop():w="operateRecorder:fail",u({errMsg:w})}}var r,t,o,a,i,s=require("../log/log.js"),n=require("../../utils/file.js"),d=require("../../stores/projectStores.js"),c=require("../../actions/webviewActions.js"),g=(require("fs"),{audio:!0}),p=6e5;_exports={operateRecorder:e}}var _exports;init(),module.exports=_exports;